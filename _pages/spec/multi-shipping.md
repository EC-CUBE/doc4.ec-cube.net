---
title: 複数配送
keywords: multi-shipping
tags: [spec, getting_started]
sidebar: home_sidebar
permalink: spec_multi-shipping
summary: 複数配送機能とは、商品購入時に、お届け先を複数のお届け先に設定できる機能です。この機能は、管理画面の設定により、有効にすることができます
---

## 2系との変更点

### 2系
- 商品種別が異なる場合、カートを分割する
- 購入はカート単位で行い、その都度支払いを行う必要がある

### 3系
- 商品種別が異なる場合でも、支払方法が一致すれば、カートは分割されず購入できる
- カートへの追加時に、共通する支払方法がない場合、カートへは追加できない
- 購入確認画面での制御は以下のとおり
    - 共通する配送方法がある場合：お届け先は分割せず、共通する配送方法を選択できる
    - 共通する配送方法がない場合：お届け先を分割し、各お届け先で配送方法を設定する
    - 支払方法は、共通する支払い方法のみ選択できる
- (未実装)ダウンロード販売への対応(プラグインでの拡張を想定)として、配送方法に、お届け先を必要とするかどうかのフラグを持たせる
    - 「配送なし」という配送方法を作成することで、お届け先の入力等をスキップさせる

## 管理画面の設定

設定＞基本情報設定＞ショップマスターを開きます。
「送料設定」の、「複数配送を有効にする」を有効にすることで、複数配送機能を利用できます。

## 複数配送有効時の購入フロー

### 複数配送を利用した購入

以下は、インストール直後の状態、会員購入でのフローです。

- 商品詳細画面から、ディナーフォークを5つカートにいれる
    - カート画面が表示される。
- レジに進むを選択する
    - 購入確認画面が表示される
- 「配送情報」欄の、お届け先を追加するを選択する
    - お届け先の複数指定画面が表示される
- 「お届け先追加」を選択し、商品のお届け先を選択する
- 選択したお届け先に送る、で購入確認画面に戻る
    - 追加した分のお届け先が増えていることが確認できる
    - 追加した分の送料が加算されていることが確認できる                                
- 「注文する」を選択し、購入を完了する

### 購入パターンの変化
商品種別、配送業者、支払方法の組み合わせにより、商品の購入パターンが変わります。

#### 支払い方法が一致しないケース

![支払方法の不一致](/images/img-multi-shipping-01.png)  

+ カートの制御

共通する支払い方法がないため、カートへの追加は不可。

+  購入確認画面

単一お届け先が生成される。複数配送への変更は可能。

#### 支払い方法が一致するケース

![支払方法の一致](/images/img-multi-shipping-02.png)  

+  カートの制御

支払い方法「カード」が共通するため、カートへの追加が可能

+  購入確認画面

お届け先は2つに分割され、なべは通常便、アイスはクール便のみ選択できる。単一お届け先への変更はできない。  
支払い方法は、カードのみが選択できる  

#### 共通する配送方法・支払い方法があるケース

![配送方法](/images/img-multi-shipping-03.png)  

+ カートの制御
支払い方法「カード」が共有するため、カートへの追加が可能

+ 購入確認画面

お届け先は単一で生成され、クール便のみ選択できる。複数配送への変更が可能。  
複数配送へ変更した場合は、なべは通常便・クール便の選択が可能、アイスはクール便のみ選択可能。  
支払い方法は、カードのみが選択できる  