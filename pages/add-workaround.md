---
title: 商品別税率が適用されないケースについての回避策(4系/3系)
tags: [spec, getting_started]
permalink: add-workaround
summary: EC-CUBEでは、税率の設定について、基本税率と商品ごとの商品別税率を設定することができます。
---

## Githubのissue[商品別税率が適用されないケースがある(4系/3系) ](https://github.com/EC-CUBE/ec-cube/issues/4330)の運用での回避策について

dtb_tax_ruleテーブルの 、 apply_date（適用日時）カラムについて、
商品管理＞商品登録で税率を登録した際に設定される税率の適用日時より、
設定＞店舗設定＞税率設定で全商品共通の税率を登録した際に設定される税率の適用日時が未来の場合に、
商品別税率が優先されず、注文手続き画面において、全商品共通の税率が適用されるという不具合がEC-CUBE:4.0.3環境で発生しています。

EC-CUBE4系についての運用での回避策としては、以下2つの回避策が考えられます。

1. 商品別税率の適用日時を商品共通の税率よりも未来の日時となるよう、SQLでデータベースを更新する。
2. 管理画面>商品管理＞商品登録 より、税率の項目を一旦空白で登録後、再度適用したい税率を入力し、再登録を行う。

### SQLでデータベースを更新する方法
`UPDATE dtb_tax_rule SET apply_date = '2019-10-20 00:00:00' WHERE id = [任意のid];`

### 商品登録より再登録を行う方法
全商品共通の税率が適用された後に商品別税率を再登録すると、適用日時が更新されます。
2.については[https://tsubo.ec-cube.net/](ネットショップの壺)で、詳しい対応策について書いておりますので、ご確認ください。